@model List<OnShelfGTDL.Models.BorrowedBooksModel>
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    ViewData["Title"] = "Borrowed Books";
}

<div>
    <div class="container-pad">
    </div>

    <div class="container-page mt-4">
        <div class="container-borrowed">
            <div class="row">
                <div class="col text-start mb-2">
                    <input type="text" id="searchBar" class="form-control d-inline-block searchBar" placeholder="Search">
                </div>
            </div>
            @foreach (var book in Model)
            {
                <div class="card borrowed-card mb-3 fs-7">
                    <div class="row g-0 mt-3 mb-3">
                        <div class="col-md-2 d-flex align-items-center justify-content-center">
                            <img src="data:image/png;base64,@Convert.ToBase64String(book.BookImage)" class="img-fluid borrowed-image" alt="BorrowedImage">
                        </div>
                        <div class="borrowed-card-details col-md-10">
                            <div class="card-body">
                                <h5 class="card-title fw-bold p-1">@book.BookName</h5>
                                <div class="row">
                                    <div class="col-md-4">
                                        <p class="card-text p-1"><strong>Author:</strong> @book.AuthorsName</p>
                                        <p class="card-text p-1"><strong>ISBN:</strong> @book.ISNB</p>
                                        <p class="card-text p-1"><strong>Category:</strong> @book.Category</p>
                                        <p class="card-text p-1"><strong>Bookshelf:</strong> @book.BookShelf</p>
                                    </div>
                                    <div class="col-md-4">
                                        <p class="card-text p-1"><strong>Borrowed Date:</strong> @book.BorrowedDate</p>
                                        <p class="card-text p-1"><strong>Overdue Date:</strong> @book.OverdueDate</p>
                                        <p class="card-text p-1">
                                            <strong>Status:</strong>
                                            <span class="badge @(book.Status == "Borrowed" ? "bg-success" : book.Status == "Due Soon" ? "bg-warning text-dark" : "bg-danger")">
                                                @book.Status
                                            </span>
                                        </p>

                                    </div>
                                </div>
                                @* <div class="row">
                                    <div class="col-md-8 d-flex align-items-center justify-content-center">
                                        <button class="btn btn-primary">Return</button>
                                    </div>
                                </div> *@
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>

    </div>
</div>
<script>
    $(document).ready(function () {
        $('#searchBar').on('keyup', function () {
            var searchTerm = $(this).val().toLowerCase();

            $('.borrowed-card').each(function () {
                var cardText = $(this).text().toLowerCase();

                if (cardText.includes(searchTerm)) {
                    $(this).show();
                } else {
                    $(this).hide();
                }
            });
        });
    });
</script>
